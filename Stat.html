<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./styles/extensions.css">
    <link rel="stylesheet" href="/styles/stylebutton.css">
    <link rel="stylesheet" href="./styles/stat.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <!-- Bootstrap Font Icon CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">

    <link rel="icon" href="/assets/logo.png">
    <title>Page stats</title>
</head>

<body class="mw-100 vh-100">
    <header class="d-flex justify-content-between align-items-center p-2 ">
        <img src="./assets/logo.png" alt="logoSite" class="logo">

        <div class="transparent_bg d-flex h-25 px-4 py-2 align-items-center justify-content-between">
            <p id="motto" class="text-light"> Discere fasciendo est vera doctrina</p>
            <div id="picAndLogout">
            </div>
        </div>

        <div class="choice d-flex flex-column align-items-center py-5">
            <div class="btn-group btn-group-toggle mb-4" data-toggle="buttons">
                <label class="btn btn-secondary active">
                    <input type="radio" name="filter1" id="filter1-0" checked>
                    <a href="student.html">Students</a>

                </label>
                <label class="btn btn-secondary">
                    <input type="radio" name="filter1" id="filter1-2">
                    <a href="#">Log out</a>

                </label>
            </div>
        </div>

    </header>
    <main>

        <div>
            <canvas id="myChart"></canvas>
        </div>

        <script>

            const ctx = document.getElementById('myChart');
            const labels = [];
            const values = [];
            const subjectToColor = {
                "Mathématiques": "red",
                "Histoire": "blue",
                "Anglais": "green",
                "Physique": "purple",
                "Français": "yellow"
            };
            fetch('./server/grades.json')
                .then(response => response.json())
                .then(data => {
                    //---------pour une valeur défini 
                    data.filter(grade => grade.subject === "Mathématiques" && grade.id_student === 1).forEach(grade => {
                        labels.push(grade.subject);
                        values.push(grade.value);
                    });
                    // -----------Pour chaque valeur
                    // data.forEach(grade => {
                    //     labels.push(grade.id_student);
                    //     values.push(grade.value);
                    // });

                    new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Notes',
                                data: values,
                                backgroundColor: labels.map(label => subjectToColor[label])
                            }]
                        },
                        options: {

                            scales: {
                                xAxes: [{
                                    ticks: {
                                        min: 0,
                                        max: 20,
                                        stepSize: 1
                                    }
                                }],
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        },
                    });
                });  
        </script>

    </main>

    <footer>
        <img src="./asset/footer.jpg" alt="footer" id="header-img">
    </footer>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.0/Chart.bundle.js"
        integrity="sha512-Q9b0myMAI+IqHh5ldQJTh3ZXkVHwlcVF+H6+LF/QU3n0XmQp7w/kjapf+I3os0GhvJcZXCr5dAhhs5AbiZafwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
        crossorigin="anonymous"></script>
    <script src="./js/teacher.js"></script>

</body>

</html>